<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Domino Score Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --card-bg: rgba(255, 255, 255, 0.9);
        }

        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --text-color: #ffffff;
            --card-bg: rgba(40, 40, 40, 0.9);
        }

        body {
            min-height: 100vh;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            color: var(--text-color);
            overflow-x: hidden;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .domino {
            position: fixed;
            width: 60px;
            height: 120px;
            background: var(--card-bg);
            border-radius: 10px;
            animation: dominoSlide 20s linear infinite;
            z-index: 0;
        }

        @keyframes dominoSlide {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200vw); }
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(5px);
            border-radius: 15px;
            color: var(--text-color);
        }

        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        .history-row {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-row:hover {
            background-color: rgba(0,0,0,0.05);
        }

        #dominoInfo {
            height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="domino" style="top: 20%; animation-delay: 0s;"></div>
    <div class="domino" style="top: 50%; animation-delay: 5s;"></div>
    <div class="domino" style="top: 80%; animation-delay: 10s;"></div>

    <div class="container py-4">
        <!-- Header -->
        <header class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="text-primary">üé≤ Domino Tracker</h1>
            <button class="btn btn-outline-secondary" onclick="toggleTheme()">
                <i class="fas fa-moon"></i>
            </button>
        </header>

        <!-- Game Setup -->
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body">
                        <h2 class="mb-3">Game Setup</h2>
                        <div class="mb-3">
                            <select id="playerCount" class="form-select" onchange="createPlayerInputs()">
                                <option value="2">2 Players</option>
                                <option value="3">3 Players</option>
                                <option value="4" selected>4 Players</option>
                            </select>
                        </div>
                        <div id="playerNames" class="row g-2"></div>
                        <button class="btn btn-primary w-100 mt-3" onclick="startGame()">Start Game</button>
                    </div>
                </div>
            </div>

            <!-- Current Game -->
            <div class="col-md-4">
                <div class="card shadow" id="gameSection" style="display: none;">
                    <div class="card-body">
                        <h2 class="mb-3">Current Game</h2>
                        <div id="scoreboard" class="mb-3"></div>
                        <div id="scoreInputs" class="row g-2 mb-3"></div>
                        <div class="d-grid gap-2">
                            <button class="btn btn-success" onclick="addRound()">Add Round</button>
                            <button class="btn btn-danger" onclick="finalizeGame()">End Game</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Domino Information -->
            <div class="col-md-4">
                <div class="card shadow">
                    <div class="card-body" id="dominoInfo">
                        <h2 class="mb-3">Domino History</h2>
                        <div class="scroll-content">
                            <p>Dominoes originated in China in the 12th century and spread to Europe in the 18th century.</p>
                            <p>Famous domino players include:</p>
                            <ul>
                                <li>Alex Lasa - World Domino Champion</li>
                                <li>Rafael Angel Martinez - Dominican Republic champion</li>
                                <li>Javier Zapata - International domino master</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game History -->
        <div class="card shadow mt-4">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h2 class="mb-0">Game History</h2>
                    <button class="btn btn-danger" onclick="showClearHistoryModal()">
                        <i class="fas fa-trash"></i> Clear History
                    </button>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Players</th>
                                <th>Winner</th>
                                <th>Rounds</th>
                            </tr>
                        </thead>
                        <tbody id="gameHistory">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <footer class="text-center mt-4">
            <div class="social-links">
                <a href="https://x.com/thekingsmakers" target="_blank" class="text-decoration-none mx-2">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="https://thekingsmakers.github.io/" target="_blank" class="text-decoration-none mx-2">
                    <i class="fas fa-globe"></i>
                </a>
            </div>
            <small class="text-muted">¬© 2024 by thekingsmaker</small>
        </footer>
    </div>

    <!-- Clear History Modal -->
    <div class="modal fade" id="clearHistoryModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">‚ö†Ô∏è Clear History</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Enter Password:</label>
                        <input type="password" class="form-control" id="clearHistoryPassword">
                    </div>
                    <div id="passwordError" class="text-danger d-none">Incorrect password!</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" onclick="clearAllHistory()">Confirm Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentGame = {
            players: [],
            rounds: [],
            totals: []
        };
        let gameHistory = JSON.parse(localStorage.getItem('dominoHistory')) || [];
        let isDarkMode = localStorage.getItem('darkMode') === 'true';

        // Theme Management
        function initializeTheme() {
            document.body.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');
            document.querySelector('.theme-toggle i').className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            localStorage.setItem('darkMode', isDarkMode);
            initializeTheme();
        }

        // Game Functions
        function createPlayerInputs() {
            const count = parseInt(document.getElementById('playerCount').value);
            const container = document.getElementById('playerNames');
            container.innerHTML = Array.from({length: count}, (_, i) => `
                <div class="col-12">
                    <input type="text" class="form-control" 
                           id="player${i+1}" placeholder="Player ${i+1} Name" required>
                </div>
            `).join('');
        }

        function startGame() {
            const count = parseInt(document.getElementById('playerCount').value);
            currentGame.players = Array.from({length: count}, (_, i) => ({
                name: document.getElementById(`player${i+1}`).value.trim() || `Player ${i+1}`,
                score: 0
            }));
            
            currentGame.rounds = [];
            currentGame.totals = Array(count).fill(0);
            
            document.getElementById('gameSection').style.display = 'block';
            updateScoreboard();
            createScoreInputs();
        }

        function createScoreInputs() {
            const container = document.getElementById('scoreInputs');
            container.innerHTML = currentGame.players.map((player, i) => `
                <div class="col-12">
                    <input type="number" class="form-control" 
                           id="score${i+1}" placeholder="${player.name}'s Score" min="0" required>
                </div>
            `).join('');
        }

        function addRound() {
            const scores = currentGame.players.map((_, i) => {
                const input = document.getElementById(`score${i+1}`);
                const value = Math.max(0, parseInt(input.value) || 0);
                input.value = '';
                currentGame.totals[i] += value;
                return value;
            });
            
            currentGame.rounds.push(scores);
            updateScoreboard();
        }

        function finalizeGame() {
            const minScore = Math.min(...currentGame.totals);
            const winnerIndex = currentGame.totals.indexOf(minScore);
            const winner = currentGame.players[winnerIndex].name;

            const gameEntry = {
                date: new Date().toLocaleString(),
                players: currentGame.players.map(p => p.name),
                rounds: currentGame.rounds,
                totals: [...currentGame.totals],
                winner: winner
            };
            
            gameHistory.unshift(gameEntry);
            localStorage.setItem('dominoHistory', JSON.stringify(gameHistory));
            updateHistoryDisplay();
            document.getElementById('gameSection').style.display = 'none';
        }

        function updateScoreboard() {
            document.getElementById('scoreboard').innerHTML = `
                <div class="d-flex flex-wrap gap-2">
                    ${currentGame.players.map((player, i) => `
                        <div class="badge bg-primary text-white p-2">
                            ${player.name}: ${currentGame.totals[i]}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function updateHistoryDisplay() {
            const container = document.getElementById('gameHistory');
            container.innerHTML = gameHistory.map((game, index) => `
                <tr class="history-row" data-bs-toggle="collapse" data-bs-target="#details-${index}">
                    <td>${game.date}</td>
                    <td>${game.players.join(', ')}</td>
                    <td>${game.winner}</td>
                    <td>${game.rounds.length}</td>
                </tr>
                <tr class="collapse" id="details-${index}">
                    <td colspan="4">
                        <div class="p-3 bg-light">
                            <h6>Detailed Scores:</h6>
                            <div class="d-flex gap-3 mb-2">
                                ${game.players.map((player, i) => `
                                    <div class="badge bg-secondary">
                                        ${player}: ${game.totals[i]}
                                    </div>
                                `).join('')}
                            </div>
                            <h6>Rounds:</h6>
                            <div class="small">
                                ${game.rounds.map((round, i) => 
                                    `Round ${i+1}: ${round.join(' - ')}`).join('<br>')}
                            </div>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function showClearHistoryModal() {
            document.getElementById('passwordError').classList.add('d-none');
            document.getElementById('clearHistoryPassword').value = '';
            new bootstrap.Modal('#clearHistoryModal').show();
        }

        function clearAllHistory() {
            const password = document.getElementById('clearHistoryPassword').value;
            if(password !== '360900') {
                document.getElementById('passwordError').classList.remove('d-none');
                return;
            }
            
            gameHistory = [];
            localStorage.setItem('dominoHistory', JSON.stringify(gameHistory));
            updateHistoryDisplay();
            new bootstrap.Modal('#clearHistoryModal').hide();
        }

        // Initialize
        initializeTheme();
        createPlayerInputs();
        updateHistoryDisplay();
    </script>
</body>
</html>
